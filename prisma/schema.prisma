generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Routine {
  id               Int      @id @default(autoincrement())
  title            String   @db.VarChar(80)
  description      String?  @db.Text
  duration         Int?
  distance         Int?
  details          String   @db.Text
  recommendedLevel Level?   @map("recommended_level")
  createdAt        DateTime @default(now()) @map("created_at")
  updatedAt        DateTime @updatedAt @map("updated_at")
  usersFav         UsersFavoriteRoutines[]

  @@map("routines")
}

model Stroke {
  id          Int    @id @default(autoincrement())
  name        String 
  description String @db.Text

  @@map("strokes")
}

model User {
  id            Int      @id @default(autoincrement())
  username      String   @unique
  email         String   @unique
  password      String
  age           Int?
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")
  favRoutines   UsersFavoriteRoutines[]
  favTips       UsersFavoriteTips[]

  @@map("users")
}

enum Level {
  BEGINNER
  INTERMEDIATE
  ADVANCED
}

model UsersFavoriteRoutines {
  routine     Routine @relation(fields: [routineId], references: [id])
  routineId   Int
  user        User @relation(fields: [userId], references: [id])
  userId      Int
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  
  @@unique([routineId, userId])
  @@map("users_favorite_routines")
}

model Tip {
  id          Int      @id @default(autoincrement())
  title       String   @db.VarChar(80)
  creator     String   @db.VarChar(80)
  description String?  @db.Text
  url         String?   @db.VarChar(255)
  level       Level?
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  usersFav    UsersFavoriteTips[]

  @@map("tips")
}

model UsersFavoriteTips {
  tip        Tip @relation(fields: [tipId], references: [id])
  tipId      Int
  user       User @relation(fields: [userId], references: [id])
  userId     Int
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")
  
  @@unique([tipId, userId])
  @@map("users_favorite_tips")
}
